from Utils.Extract_feature import extract_ngrams, extract_bytes_sequence
from pathlib import Path
import pandas as pd

data_dir = Path("data")
smp_dir = data_dir.joinpath("samples")
ftr_dir = Path("pre-extract")
if not ftr_dir.exists():
    ftr_dir.mkdir()

if __name__ == '__main__':
    lbls = pd.read_csv(data_dir.joinpath("trainLabels.csv"))
    lbls["Id"] = lbls["Id"].astype(str)
    lbls["Class"] = lbls["Class"].astype("category")
    lbls.set_index("Id", inplace=True)
    bytes_ngram_vct, bytes_ngrams = extract_ngrams(lbls.index, extract_bytes_sequence, 4)
    print(bytes_ngrams.shape)
