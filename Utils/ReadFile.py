from typing import List
from pathlib import Path

data_dir = Path("data")
smp_dir = data_dir.joinpath("samples")


class ReadFile:
    @staticmethod
    def bytes_reader(id: str) -> List[str]:
        with smp_dir.joinpath(id + ".bytes").open() as file:
            data = file.read()
        file_split = data.split()
        byte_list = []
        for element in file_split:
            if len(element) == 2 and element != "??":
                byte_list.append(element)
        return byte_list

    @staticmethod
    def asm(id: str) -> str:
        with smp_dir.joinpath(id + ".asm").open(encoding="utf-8", errors="ignore") as file:
            return file.read()

    @staticmethod
    def asm_lines(id: str) -> List[str]:
        with smp_dir.joinpath(id + ".asm").open(encoding="utf-8", errors="ignore") as file:
            return file.readlines()

    @staticmethod
    def apis(id: str) -> List[str]:
        with data_dir.joinpath("Andrea_Microsoft").joinpath(id + ".apis").open() as file:
            data = file.read()
        file_split = data.split("\n")
        return file_split

    @staticmethod
    def entropy(id: str) -> list[list]:
        sections_values = []
        with data_dir.joinpath("Andrea_Microsoft").joinpath(id + ".entropy").open() as file:
            data = file.read().replace("Section", ":").replace("b'", " ").replace("'", " ").replace(":", " ").split()
        single_element = []
        for i, elem in enumerate(data):
            if i % 2 == 0:
                single_element = [elem]
            else:
                single_element.append(elem)
                sections_values.append(single_element)
        return sections_values

    @staticmethod
    def bytes_microsoft(id: str) -> List[str]:
        with data_dir.joinpath("Andrea_Microsoft").joinpath(id + ".bytes").open() as file:
            data = file.read()
        file_split = data.split()
        byte_list = []
        for element in file_split:
            if len(element) == 2 and element != "??":
                byte_list.append(element)
        return byte_list
