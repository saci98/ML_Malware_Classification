from pathlib import Path
import pandas as pd


ftr_dir = Path("pre-extract")
if not ftr_dir.exists():
    ftr_dir.mkdir()


class CSVReader:
    def __init__(self, name_file: str) -> None:
        self.name_file = name_file

    def save(self, data: pd.DataFrame) -> None:
        data.to_csv(ftr_dir.joinpath(self.name_file))

    def load(self) -> pd.DataFrame | None:
        path = ftr_dir.joinpath(self.name_file)
        return pd.read_csv(path).set_index("ID") if path.exists() else None
